<div class="mood-widget">
    <h3>Jak se dnes c√≠t√≠≈°?</h3>

    <div class="slider-row">
        <span class="emoji">üò°</span>
        <input type="range" min="0" max="4" step="1" value="2" id="moodSlider">
        <span class="emoji">üòÑ</span>
    </div>

    <div class="selected-mood">
        Vybran√° n√°lada: <span id="currentMood">üòê</span>
    </div>

    <button id="saveBtn">Ulo≈æit n√°ladu</button>

    <div id="historyToggle" style="display:none; cursor:pointer; margin-top:10px; font-size:14px;">
        Zobrazit historii
    </div>
    <div id="moodHistory" style="display:none; margin-top:8px; font-size:14px;"></div>

</div>
<script>
    const s = moodSlider, m = currentMood, b = saveBtn,
        E = ["üò°", "üòï", "üòê", "üôÇ", "üòÑ"],
        K = "moodHistory",
        d = new Date().toISOString().slice(0, 10),
        h = JSON.parse(localStorage.getItem(K)) || {},
        t = historyToggle,
        x = moodHistory;

    s.oninput = () => m.textContent = E[s.value];

    const lock = v => (s.value = v, m.textContent = E[v], s.disabled = b.disabled = true, b.textContent = "Dne≈°n√≠ n√°lada ulo≈æena");

    const render = () => {
        const e = Object.entries(h).sort((a, b) => b[0].localeCompare(a[0]));
        if (!e.length) return;
        t.style.display = "block";
        x.innerHTML = e.map(([d, v]) => `${d}: ${E[v]}`).join("<br>");
    };

    t.onclick = () => {
        const o = x.style.display === "block";
        x.style.display = o ? "none" : "block";
        t.textContent = o ? "Zobrazit historii ‚ñº" : "Skr√Ωt historii ‚ñ≤";
    };

    if (h[d] != null) { lock(h[d]); render(); }
    else b.onclick = () => (
        h[d] = +s.value,
        localStorage.setItem(K, JSON.stringify(h)),
        lock(h[d]),
        render()
    );
</script>
<style>
    :root {
        --border-radius: 12px;
    }

    body {
        font-family: Arial, sans-serif;
    }

    .mood-widget {
        width: 280px;
        padding: 16px;
        border: 2px solid var(--outline-primary);
        border-radius: var(--border-radius);
        background: var(--widget-in-widget);
        text-align: center;
        color: var(--widget-text);
    }

    .mood-widget h3 {
        margin-bottom: 12px;
    }

    .slider-row {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 12px;
    }

    .emoji {
        font-size: 24px;
    }

    input[type="range"] {
        flex: 1;
        appearance: none;
        height: 8px;
        border-radius: 4px;
        background: var(--outline-primary);
        outline: none;
    }

    input[type="range"]::-webkit-slider-thumb,
    input[type="range"]::-moz-range-thumb {
        width: 26px;
        height: 26px;
        border-radius: 50%;
        background: var(--outline-primary);
        cursor: pointer;
    }

    .selected-mood {
        margin-bottom: 12px;
    }

    button {
        padding: 8px 14px;
        border: none;
        border-radius: 8px;
        background: var(--outline-primary);
        color: white;
        font-size: 14px;
        cursor: pointer;
    }

    button:hover:not(:disabled) {
        background: var(--outline-primary-dark);
    }

    button:disabled {
        background: #aaa;
        cursor: not-allowed;
    }
</style>